;; The first three lines of this file were inserted by DrRacket. They record metadata
;; about the language level of this file in a form that our tools can easily process.
#reader(lib "htdp-beginner-reader.ss" "lang")((modname info-plan) (read-case-sensitive #t) (teachpacks ((lib "guess.rkt" "teachpack" "htdp"))) (htdp-settings #(#t constructor repeating-decimal #f #t none #f ((lib "guess.rkt" "teachpack" "htdp")) #f)))
;estructuras
(define-struct info-hotel (nombre  numNoches costoNoche infoHabitacion))
(define-struct info-habitacion (numCamas numBa単os numDuchas))

(define-struct info-transporte (ciudadOrigen ciudadDestino valorTiquete numPersonas otros))
(define-struct otros-viaje-info (aeropuerto ni単os-ancianos))

(define-struct info-guia (ciudad nomPlan numSitios valorSitio))

(define-struct info-plan (valorHotel valorTransporte valorPlanGuia valorTotal))

;autor: Harold Montano 1968067-3743
;fecha: 08 de Enero, 2020
;contrato: calcular-hotel: info-hotel -> num
(define (calcular-hotel info-h)
  (* (info-hotel-costoNoche info-h) (info-hotel-numNoches info-h)
     (if (or (> (info-habitacion-numCamas (info-hotel-infoHabitacion info-h)) 2)
             (> (info-habitacion-numBa単os (info-hotel-infoHabitacion info-h)) 3)
             (> (info-habitacion-numDuchas (info-hotel-infoHabitacion info-h)) 2)
             )
         1.25
         1
        )
    )
 )

;autor: Harold Montano 1968067-3743
;fecha: 08 de Enero, 2020
;contrato: calcular-transporte: info-transporte -> num
(define (calcular-costo-transporte info-t)
 (*
  (+
   (* (info-transporte-valorTiquete info-t) (info-transporte-numPersonas info-t))
   (otros-viaje-info-aeropuerto (info-transporte-otros info-t))
   (otros-viaje-info-ni単os-ancianos (info-transporte-otros info-t))
  )
 (if
  (> (info-transporte-numPersonas info-t) 5)
  0.6
  1
  )
 )
)

;autor: Harold Montano 1968067-3743
;fecha: 08 de Enero, 2020
;contrato: calcular-valor-guia: info-guia -> num
(define (calcular-valor-guia info-g)
  (*
   (info-guia-numSitios info-g) (info-guia-valorSitio info-g)
     (if
      (> (info-guia-numSitios info-g) 4)
      1.2
      1
     )
    )
 )


;autor: Harold Montano 1968067-3743
;fecha: 08 de Enero, 2020
;contrato: calcular-valor-plan: info-hotel, info-transporte, info-guia -> info-plan
;proposito: presentar en una estructura el costo total de un viaje truristico.
;ejemplos:

;definicion
(define (calcular-valor-plan info-h info-t info-g)
  (make-info-plan
   (calcular-hotel info-h)
   (calcular-costo-transporte info-t)
   (calcular-valor-guia info-g)
   (+ (calcular-hotel info-h) (calcular-costo-transporte info-t) (calcular-valor-guia info-g))
  )
)
;pruebas
